<!DOCTYPE html>
<html lang="en">
  <head>
    {% load static %}
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Mi Tienda 😁</title>
    <!-- CSS de BS5 -->
    <link
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
      rel="stylesheet"
      integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH"
      crossorigin="anonymous"
    />
    <!-- CSS DATATABLE -->
    <link
      rel="stylesheet"
      href="https://cdn.datatables.net/2.1.8/css/dataTables.bootstrap5.css"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css"
    />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
      /* Estilos para la navegación */
      body {
        display: flex;
        min-height: 100vh;
        margin: 0;
        background-color: #ffe9cc;
      }

      .bg-dark {
        width: 250px;
        height: 100vh;
      }

      .container-content {
        flex-grow: 1;
        padding: 2rem;
        width: 100%;
      }

      /* Estilos para la tabla */
      .table-responsive {
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
      }

      .table {
        margin-top: 1rem;
      }
    </style>
  </head>

  <body>
    <!-- Barra lateral izquierda -->
    <nav
      class="bg-dark p-3 d-flex flex-column"
      style="width: 250px; height: 100vh"
    >
      <div class="text-center mb-4">
        <img
          src="{% static 'img/logo.jpg' %}"
          alt="Logo AmiStore"
          class="img-fluid"
          style="width: 150px; border-radius: 50%"
        />
      </div>
      <h2 class="text-center text-white mb-4">AMISTORE</h2>
      <ul class="nav flex-column flex-grow-1">
        <li class="nav-item mb-2">
          <a href="" class="nav-link text-white"
            ><i class="fa-solid fa-home me-2"></i>Inicio</a
          >
        </li>
        <li class="nav-item mb-2">
          <a href="" class="nav-link text-white"
            ><i class="fa-solid fa-copy me-2"></i>Administrar Usuarios</a
          >
        </li>
      </ul>

      <ul class="nav flex-column">
        <li class="nav-item mb-2">
          <a href="" class="nav-link text-white"
            ><i class="fa-solid fa-right-from-bracket me-2"></i>Cerrar Sesión</a
          >
        </li>
      </ul>
    </nav>

    <!-- Contenedor Principal -->
    <div class="container-content">
      <div class="d-flex justify-content-between align-items-center">
        <h1 class="mb-0">Gestion de Inventario</h1>
      </div>

      <div class="alert alert-info mt-4" role="alert">
        <i class="fa-solid fa-info-circle"></i> Bienvenido a la gestión de
        inventario.
      </div>

      <div style="flex: auto; text-align: end">
        <a href="" class="btn btn-primary">
          <i class="fa-solid fa-plus"></i>
          Agregar Producto
        </a>
      </div>

      <!-- Tabla estilo DataTables -->
      <div class="table-responsive">
        <table
          id="example"
          class="table table-striped table-bordered"
          style="width: 100%"
        >
          <thead>
            <tr class="table-primary">
              <th scope="col">ID</th>
              <th scope="col">Nombre</th>
              <th scope="col">Descripción</th>
              <th scope="col">Precio</th>
              <th scope="col">Categoria</th>
            </tr>
          </thead>
          <tbody>
            {% if productos %} {% for producto in productos %}
            <tr class="table-light">
              <th scope="row">{{ producto.id }}</th>
              <td>{{ producto.nombre }}</td>
              <td>{{ producto.descripcion }}</td>
              <td>{{ producto.precio }}</td>
              <td>{{ producto.categoria }}</td>
              <td style="text-align: center">
                <button
                  data-bs-toggle="modal"
                  data-bs-target="#addProductModal"
                  class="add-button btn btn-primary"
                  data-id="{{ producto.id }}"
                >
                  <i class="fa-solid fa-pen"></i>
                </button>

                <button type="button" class="btn btn-danger" data-bs-toggle="modal" data-bs-target="#exampleModal{{ producto.id }}"><i class="bi bi-trash"></i></button>
              </td>
                          <!-- Modal -->
            <div class="modal fade" id="exampleModal{{ producto.id }}" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog">
                <div class="modal-content">
                  <div class="modal-header">
                    <h1 class="modal-title fs-5" id="exampleModalLabel">Eliminar producto</h1>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>
                  <div class="modal-body">
                    <p>¿Estás seguro de que deseas eliminar el producto {{producto.id}}?</p>
                  </div>
                  <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cancelar</button>
                    <a type="button" href="" class="btn btn-danger">Eliminar</a>
                  </div>
                </div>
              </div>
            </div>
            </tr>
            {% endfor %} {% else %}
            <tr>
              <td colspan="6" class="text-center">
                No hay productos registrados
              </td>
            </tr>
            {% endif %}
          </tbody>
        </table>
        <div class="d-flex justify-content-initial mb-2 mt-4 ms-2">
          <a href="{% url 'index' %}" class="btn btn-danger"
            ><i class="fa-solid fa-arrow-left"></i> Volver</a
          >
        </div>
      </div>
    </div>

    <div
    class="modal fade"
    id="addProductModal"
    tabindex="-1"
    aria-labelledby="addProductModalLabel"
    aria-hidden="true"
  >
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="addProductModalLabel">
            Modificar stock
          </h5>
          <button
            type="button"
            class="btn-close"
            data-bs-dismiss="modal"
            aria-label="Close"
          ></button>
        </div>
        <div class="modal-body">
          <form
            method="post"
            class="col-12 border border-info rounded p-4"
            id="addProductForm"
          >
            {% csrf_token %}
            
            <!-- Campo de ID del Producto -->
            <div class="mb-3 row">
              <label for="productId" class="col-sm-4 col-form-label">ID</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" id="productId" name="id" readonly />
              </div>
            </div>
  
            <!-- Campo de Nombre -->
            <div class="mb-3 row">
              <label for="productName" class="col-sm-4 col-form-label">Nombre</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" id="productName" name="nombre" />
              </div>
            </div>
  
            <!-- Campo de Descripción -->
            <div class="mb-3 row">
              <label for="productDescripcion" class="col-sm-4 col-form-label">Descripción</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" id="productDescripcion" name="descripcion" />
              </div>
            </div>
  
            
            <!-- Campo de Precio -->
            <div class="mb-3 row">
                <label for="productPrice" class="col-sm-4 col-form-label">Precio</label>
                <div class="col-sm-8">
                    <input type="text" class="form-control" id="productPrice" name="precio" />
                </div>
            </div>
            
            <!-- Campo de Categoría -->
            <div class="mb-3 row">
              <label for="productCategory" class="col-sm-4 col-form-label">Categoría</label>
              <div class="col-sm-8">
                <input type="text" class="form-control" id="productCategory" name="categoria" />
              </div>
            </div>
  
          </form>
          <input type="hidden" id="csrfToken" value="{{ csrf_token }}" />
        </div>
        <div class="modal-footer">
          <button
            type="button"
            class="btn btn-secondary"
            data-bs-dismiss="modal"
          >
            Cancelar
          </button>
          <button type="button" class="btn btn-primary" id="addProductButton">
            Guardar
          </button>
        </div>
      </div>
    </div>
  </div>
    <!-- Modal de eliminación de producto -->
<!-- Modal de Confirmación para Eliminar Producto -->
    <!-- JS de BS5 -->
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
      crossorigin="anonymous"
    ></script>
    <!-- JS DATATABLE -->
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/5.3.0/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.datatables.net/2.1.8/js/dataTables.js"></script>
    <script src="https://cdn.datatables.net/2.1.8/js/dataTables.bootstrap5.js"></script>
    <script>
      $(document).ready(function () {
        $("#example").DataTable({
          language: {
            url: "https://cdn.datatables.net/plug-ins/1.10.20/i18n/Spanish.json",
          },
          pageLength: 10,
          lengthMenu: [5, 10, 25, 50],
        });
      });
    </script>
  </body>
</html>
